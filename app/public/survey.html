<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <!--bootstrap-->
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"> -->
    <!--jquery link-->
    <!-- <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
   
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
     -->
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" /> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

</head>

<body>
    <div class="container">
        <div class="row">
            <h1>Survey Questions</h1>
        </div>
        <form action="/api/friends" method="GET">
            <div class="row">
                <h2>About You</h2>
            </div>
            <div class="form-group questions">
                <label for="nameFormControlInput">Name (Required)</label>
                <input type="text" name="name" class="form-control" id="nameFormControl"
                    placeholder="type your name here" required=''>
            </div>
            <div class="form-group">
                <label for="photoFormControlInput">Link to Photo Image (Required)</label>
                <input type="text" name="photo" class="form-control" id="photoFormControl"
                    placeholder="add a link to your photo" required=''>
            </div>
            <form>
                <div class="questions">
                    <h3>Question 1</h3>
                    <h5>Your mind is always buzzing with unexplored ideas and plans.</h5>
                    <div class="form-group">
                        <select name="Q1" class="form-control" id="Q" required=''>
                            <option value="">Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>

                <div class="questions">
                    <h3>Question 2</h3>
                    <h5>Generally speaking, you rely more on your experience than your imagination.</h5>
                    <div class="form-group">
                        <select name="Q2" class="form-control" id='Q' required=''>
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 3</h3>
                    <h5>You find it easy to stay relaxed and focused even when there is some pressure.</h5>
                    <div class="form-group">
                        <label for="Q">Example select</label>
                        <select name="Q3" class="form-control" id="Q" required=''>
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 4</h3>
                    <h5>You rarely do something just out of sheer curiosity.</h5>
                    <div class="form-group">
                        <select name="Q4" class="form-control" id="Q">
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 5</h3>
                    <h5>People can rarely upset you.</h5>
                    <div class="form-group">
                        <select name="Q5" class="form-control" id="Q">
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 6</h3>
                    <h5>It is often difficult for you to relate to other people’s feelings.</h5>
                    <div class="form-group">
                        <select name="Q6" class="form-control" id="Q">
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 7</h3>
                    <h5>In a discussion, truth should be more important than people’s sensitivities.</h5>
                    <div class="form-group">
                        <select name="Q7" class="form-control" id="Q">
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 8</h3>
                    <h5>You rarely get carried away by fantasies and ideas.</h5>
                    <div class="form-group">
                        <select name="Q8" class="form-control" id="Q">
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 9</h3>
                    <h5>You think that everyone’s views should be respected regardless of whether they are supported by
                        facts or not.
                    </h5>
                    <div class="form-group">
                        <select name="Q9" class="form-control" id="Q">
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <div class="questions">
                    <h3>Question 10</h3>
                    <h5>You feel more energetic after spending time with a group of people.</h5>
                    <div class="form-group">
                        <select name="Q10" class="form-control" id="Q">
                            <option value="" selected data-default>Select an Option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary mb-2" id="submit-btn"> Submit</button>
            </form>

            <button id="modal" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">View
                Match!</button>

            <!-- Modal -->
            <div class="modal fade" id="myModal" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Your Results</h4>
                        </div>
                        <div class="modal-body">

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </div>

            </div>

    </div>

    <!--Use jquery to grab values-->

    <script type="text/javascript">
        var friendPotential;
        $(document).ready(function () {
            var compatibility = [];
            $.ajax({ url: "/api/friends", method: "GET" })
                .then(function (data) {
                    console.log(data)
                    friendPotential = data
                })
            console.log(friendPotential)

            $("form").on("submit", function (event) {
                event.preventDefault();
                var results = $(".form-control").serializeArray();
                let userInput = $('#Q').val();
                let totalP = 0;
                console.log(userInput + " userinput")
                console.log("--------------------")
                console.log(results)

                $.ajax({ url: "/api/friends", method: "GET" })
                    .then(function (data) {
                        for (var i = 0; i < data.length; i++) {
                            var re = helperFunction(results, data[i], data[i].name, data[i].photo)
                            compatibility.push(re)
                        }
                        var match = compatibleResults()
                        console.log(match)
                        var template = "<h1>" + match.name + "</div>" +
                            "<img src=" + match.photo + ">"
                        $(".modal-body").append(template)
                        $("#myModal").trigger()

                    })
                // console.log(compatibility)


            })
            let helperFunction = function (arr1, arr2, name, pic) {
                var difference = 0
                for (var i = 2; i < arr1.length; i++) {
                    console.log(arr1[i].value)
                    let myResults = arr1[i].value
                    console.log(arr2.scores[i - 2] + " the scores")
                    let friendResults = arr2.scores[i - 2]
                    difference += Math.abs(myResults - friendResults)
                }
                return { name: name, photo: pic, compatScore: difference }

            }
            var compatibleResults = function () {
                var compatPoints = 50;
                var person;
                for (var i = 0; i < compatibility.length; i++) {
                    // console.log(compatibility[i])
                    if (compatPoints > compatibility[i].compatScore) {
                        compatPoints = compatibility[i].compatScore;
                        // console.log(compatPoints)
                        person = compatibility[i];
                    }
                }
                // console.log(person)
                return person

            }

        });
    </script>

</body>

</html>